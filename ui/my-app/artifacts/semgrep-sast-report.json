{"errors": [{"code": 3, "level": "warn", "message": "Syntax error at line artifacts/gitleaks-secrets-report.json:1:\n missing element", "path": "artifacts/gitleaks-secrets-report.json", "type": "Syntax error"}, {"code": 3, "level": "warn", "message": "Syntax error at line artifacts/semgrep-sast-report.json:1:\n missing element", "path": "artifacts/semgrep-sast-report.json", "type": "Syntax error"}], "interfile_languages_used": [], "paths": {"scanned": [".gitignore", "Dockerfile", "artifacts/clamav-virus-report.txt", "artifacts/gatecheck-bundle.tar.gz", "artifacts/gitleaks-secrets-report.json", "artifacts/grype-vulnerability-report-full.json", "artifacts/semgrep-sast-report.json", "artifacts/syft-sbom-report.json", "deployment-ui.yaml", "package.json", "public/favicon.ico", "public/index.html", "public/logo192.png", "public/logo512.png", "public/manifest.json", "public/robots.txt", "service-ui.yaml", "src/App.test.tsx", "src/App.tsx", "src/ColorModeSwitcher.tsx", "src/Logo.tsx", "src/index.tsx", "src/logo.svg", "src/react-app-env.d.ts", "src/reportWebVitals.ts", "src/serviceWorker.ts", "src/setupTests.ts", "src/test-utils.tsx", "tsconfig.json"]}, "results": [{"check_id": "dockerfile.security.missing-user.missing-user", "end": {"col": 35, "line": 13, "offset": 317}, "extra": {"engine_kind": "OSS", "fingerprint": "c6fafae6c7bb045cd4b7fe70ea41e04f924f732554fca45fc44f35b44c954cb688e213e935442285abdf6a8b04550f3c1971db94b66b78c2dcb528d6dda06470_0", "fix": "USER non-root\nCMD [\"nginx\", \"-g\", \"daemon off;\"]", "is_ignored": false, "lines": "CMD [\"nginx\", \"-g\", \"daemon off;\"]", "message": "By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-269: Improper Privilege Management"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A04:2021 - Insecure Design"], "references": ["https://owasp.org/Top10/A04_2021-Insecure_Design"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 20148, "rule_id": "AbUN06", "rv_id": 833486, "url": "https://semgrep.dev/playground/r/nWTy4lK/dockerfile.security.missing-user.missing-user", "version_id": "nWTy4lK"}}, "shortlink": "https://sg.run/Gbvn", "source": "https://semgrep.dev/r/dockerfile.security.missing-user.missing-user", "subcategory": ["audit"], "technology": ["dockerfile"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$...VARS": {"abstract_content": "[\"nginx\"\"-g\"\"daemon off;\"]", "end": {"col": 35, "line": 13, "offset": 317}, "start": {"col": 5, "line": 13, "offset": 287}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "Dockerfile", "start": {"col": 1, "line": 13, "offset": 283}}, {"check_id": "yaml.kubernetes.security.run-as-non-root.run-as-non-root", "end": {"col": 9, "line": 15, "offset": 251}, "extra": {"engine_kind": "OSS", "fingerprint": "83e93380a3832151b959cc65bd0c9f00968d3294802e4a801ee4c0bcc5244eafa8524f7b45c50de577b1f1df60660fa85a9a03d42438f9d19580fdb725449d9b_0", "fix": "spec:\n      securityContext:\n        runAsNonRoot: true #", "is_ignored": false, "lines": "    spec:", "message": "When running containers in Kubernetes, it's important to ensure that they  are properly secured to prevent privilege escalation attacks.  One potential vulnerability is when a container is allowed to run  applications as the root user, which could allow an attacker to gain  access to sensitive resources. To mitigate this risk, it's recommended to  add a `securityContext` to the container, with the parameter `runAsNonRoot`  set to `true`. This will ensure that the container runs as a non-root user,  limiting the damage that could be caused by any potential attacks. By  adding a `securityContext` to the container in your Kubernetes pod, you can  help to ensure that your containerized applications are more secure and  less vulnerable to privilege escalation attacks.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-250: Execution with Unnecessary Privileges"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/", "https://kubernetes.io/docs/concepts/policy/pod-security-policy/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-2-set-a-user"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10134, "rule_id": "ZqUqeK", "rv_id": 835331, "url": "https://semgrep.dev/playground/r/2KT7O6O/yaml.kubernetes.security.run-as-non-root.run-as-non-root", "version_id": "2KT7O6O"}}, "shortlink": "https://sg.run/dgP5", "source": "https://semgrep.dev/r/yaml.kubernetes.security.run-as-non-root.run-as-non-root", "subcategory": ["audit"], "technology": ["kubernetes"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$1": {"abstract_content": "spec", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$SPEC": {"abstract_content": "spec", "end": {"col": 9, "line": 15, "offset": 251}, "start": {"col": 5, "line": 15, "offset": 247}}}, "severity": "INFO", "validation_state": "NO_VALIDATOR"}, "path": "deployment-ui.yaml", "start": {"col": 5, "line": 15, "offset": 247}}, {"check_id": "yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext", "end": {"col": 13, "line": 17, "offset": 283}, "extra": {"engine_kind": "OSS", "fingerprint": "69d633bb3ce08359b396a6de8747ee75fcf74d0f61418a9320d3e21ed6814add3671960c6911d0c36a59ad06d112eea039320798abb6c404126d9779af78d88a_0", "fix": "securityContext:\n          allowPrivilegeEscalation: false\n        name", "is_ignored": false, "lines": "      - name: hello-world-k8s-ui", "message": "In Kubernetes, each pod runs in its own isolated environment with its own set of security policies. However, certain container images may contain `setuid` or `setgid` binaries that could allow an attacker to perform privilege escalation and gain access to sensitive resources. To mitigate this risk, it's recommended to add a `securityContext` to the container in the pod, with the parameter `allowPrivilegeEscalation` set to `false`. This will prevent the container from running any privileged processes and limit the impact of any potential attacks. By adding a `securityContext` to your Kubernetes pod, you can help to ensure that your containerized applications are more secure and less vulnerable to privilege escalation attacks.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://kubernetes.io/docs/concepts/policy/pod-security-policy/#privilege-escalation", "https://kubernetes.io/docs/tasks/configure-pod-container/security-context/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 47276, "rule_id": "WAU5J6", "rv_id": 835317, "url": "https://semgrep.dev/playground/r/RGTKxwB/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext", "version_id": "RGTKxwB"}}, "shortlink": "https://sg.run/eleR", "source": "https://semgrep.dev/r/yaml.kubernetes.security.allow-privilege-escalation-no-securitycontext.allow-privilege-escalation-no-securitycontext", "subcategory": ["vuln"], "technology": ["kubernetes"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$CONTAINER": {"abstract_content": "hello-world-k8s-ui", "end": {"col": 33, "line": 17, "offset": 303}, "start": {"col": 15, "line": 17, "offset": 285}}, "$NAME": {"abstract_content": "name", "end": {"col": 13, "line": 17, "offset": 283}, "start": {"col": 9, "line": 17, "offset": 279}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "deployment-ui.yaml", "start": {"col": 9, "line": 17, "offset": 279}}, {"check_id": "typescript.react.security.react-insecure-request.react-insecure-request", "end": {"col": 43, "line": 40, "offset": 945}, "extra": {"engine_kind": "OSS", "fingerprint": "ec519626a38292f5749a79200b39191e5ec674a8a09df2e6b6f88329d182e0aa199fdd1891e9eb91e909ad040d0b038e3af0488e4296e118e53e8f048efab794_0", "is_ignored": false, "lines": "    fetch(\"http://localhost:8000/message\")", "message": "Unencrypted request over HTTP detected.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-319: Cleartext Transmission of Sensitive Information"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://www.npmjs.com/package/axios"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9766, "rule_id": "NbUA3O", "rv_id": 835296, "url": "https://semgrep.dev/playground/r/kbT2PZK/typescript.react.security.react-insecure-request.react-insecure-request", "version_id": "kbT2PZK"}}, "shortlink": "https://sg.run/1n0b", "source": "https://semgrep.dev/r/typescript.react.security.react-insecure-request.react-insecure-request", "subcategory": ["vuln"], "technology": ["react"], "vulnerability": "Insecure Transport", "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "src/App.tsx", "start": {"col": 5, "line": 40, "offset": 907}}], "skipped_rules": [], "version": "1.90.0"}
